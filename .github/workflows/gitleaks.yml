name: gitleaks-scan

on:
  workflow_call:
    secrets:
      GITLEAKS_LICENSE:
        required: true   # ðŸ‘ˆ youâ€™ll pass the license from org secrets

jobs:
  scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      # Run Gitleaks using your custom config file
      - name: Run Gitleaks Scan
        uses: gitleaks/gitleaks-action@v2
        with:
          args: detect --source . --config .github/gitleaks.toml --exit-code 1
        env:
          GITLEAKS_LICENSE: "FF2062-5126C7-2E2CD7-38B07D-25F736-V3"



